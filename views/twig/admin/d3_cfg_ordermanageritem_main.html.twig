{% include "headitem.html.twig" with {title: "GENERAL_ADMIN_TITLE"|translate} %}

<script type="text/javascript">
    <!--
    {% if updatelist == 1 %}
        UpdateList('{{ oxid }}');
    {% endif %}

    function UpdateList( sID)
    {
        let oSearch = parent.list.document.getElementById("search");
        oSearch.oxid.value=sID;
        oSearch.fnc.value='';
        oSearch.submit();
    }

    function EditThis( sID)
    {
        let oTransfer = document.getElementById("transfer");
        oTransfer.oxid.value=sID;
        oTransfer.cl.value='{{ oViewConf.getActiveClassName() }}';
        oTransfer.submit();

        let oSearch = parent.list.document.getElementById("search");
        oSearch.actedit.value = 0;
        oSearch.oxid.value=sID;
        oSearch.submit();
    }

    function ChangeLstrt()
    {
        let oSearch = document.getElementById("search");
        if (document.search != null && document.search.lstrt != null)
            oSearch.lstrt.value=0;
    }
    -->
</script>

<style>
    fieldset legend {
        color: #A0A0A0;
    }
    fieldset table {
        width: 100%;
    }
    fieldset table td:nth-child(1) {
        width: 80%;
        white-space: normal;
    }
    fieldset table td #debugnote {
        font-size: 9px;
    }
    fieldset table td:nth-child(2) {
        width: 20%;
        text-align: right;
    }
    details, .restrictioninfo {
        margin: 0 0 15px;
        padding: 6px 9px 2px 18px;
        border: 1px solid silver;
        color: silver;
        border-radius: .25rem;
        border-left: .25rem #028fe8 solid;
    }
    details summary {
        margin: 0 0 3px -12px;
        cursor: pointer;
    }
    .restrictioninfo {
        color: black;
    }
</style>

{% if readonly %}
    {% set readonly = "readonly disabled" %}
{% else %}
    {% set readonly = "" %}
{% endif %}

<form name="transfer" id="transfer" action="{{ oViewConf.getSelfLink()|raw }}" method="post">
    {{ oViewConf.getHiddenSid()|raw }}
    <input type="hidden" name="oxid" value="{{ oxid }}">
    <input type="hidden" name="oxidCopy" value="{{ oxid }}">
    <input type="hidden" name="cl" value="{{ oViewConf.getActiveClassName() }}">
    <input type="hidden" name="editlanguage" value="{{ editlanguage }}">
</form>

<form name="myedit" id="myedit" action="{{ oViewConf.getSelfLink()|raw }}" method="post" style="padding: 0;margin: 0;height:0;">
    {{ oViewConf.getHiddenSid()|raw }}
    <input type="hidden" name="cl" value="{{ oViewConf.getActiveClassName() }}">
    <input type="hidden" name="fnc" value="">
    <input type="hidden" name="oxid" value="{{ oxid }}">
    <input type="hidden" name="voxid" value="{{ oxid }}">
    <input type="hidden" name="editval[{{ edit.d3GetFieldLongName('oxid') }}]" value="{{ oxid }}">

    <table style="width:98%; padding: 0; border: none">
        {% if edit.getId() and not edit.getLicenseActive() %}
            <tr>
                <td style="vertical-align:top;" colspan="2">
                    <div class="extension_warning">{{ translate({ ident: "D3_ORDERMANAGER_ERROR_IEXECJOBSLIMIT" }) }}</div>
                </td>
            </tr>
        {% endif %}

        <tr>
            <td class="edittext" colspan="2">
                <details>
                    <summary>{{ translate({ ident: "D3_GENERAL_ORDERMANAGER_DESCRIPTION" }) }}</summary>
                    {{ translate({ ident: "d3tbclordermanager_items_main_desc" }) }}
                </details>
            </td>
        </tr>

        {% if edit.getBasicRestrictionSettings() %}
            <tr>
                <td class="restrictioninfo" colspan="2">
                    {{ translate({ ident: "D3_GENERAL_ORDERMANAGER_BASICRESTRICTIONS" }) }}
                </td>
            </tr>
        {% endif %}

        <tr>
            <td class="edittext" style="text-align:left; vertical-align:top; height:99%;padding-left:5px;padding-bottom:30px;padding-top:10px;">

                <table style="border: none; padding: 0;">
                    <tr>
                        <td class="edittext">
                            <label for="MainTitle">{{ translate({ ident: "D3_MODPROFILE_MAIN_TITLE" }) }}</label>&nbsp;
                        </td>
                        <td class="edittext">
                            <input id="MainTitle" type="text" class="editinput" size="50" maxlength="{{ edit.d3getFieldMaxLength('oxtitle') }}" name="editval[{{ edit.d3GetFieldLongName('oxtitle') }}]" value="{{ edit.getFieldData('oxtitle') }}" {{ readonly }}>
                        </td>
                    </tr>
                    <tr>
                        <td class="edittext">
                            <label for="MainShortDesc">{{ translate({ ident: "D3_MODPROFILE_MAIN_SHORTDESC" }) }}</label>&nbsp;
                        </td>
                        <td class="edittext">
                            <textarea id="MainShortDesc"  name="editval[{{ edit.d3GetFieldLongName('oxshortdesc') }}]" class="editinput" maxlength="{{ edit.d3getFieldMaxLength('oxshortdesc') }}" cols="50" rows="5" {{ readonly }}>{{ edit.getFieldData('oxshortdesc') }}</textarea>
                        </td>
                    </tr>
                    <tr>
                        <td class="edittext">
                            <label for="MainSort">{{ translate({ ident: "D3_MODPROFILE_MAIN_SORT" }) }}</label>&nbsp;
                        </td>
                        <td class="edittext">
                            <input id="MainSort" type="text" class="editinput" size="32" maxlength="{{ edit.d3getFieldMaxLength('oxsort') }}" name="editval[{{ edit.d3GetFieldLongName('oxsort') }}]" value="{{ edit.getFieldData('oxsort') }}" {{ readonly }}>
                            {% include "inputhelp.html.twig" with {'sHelpId': help_id("D3_ORDERMANAGER_MAIN_SORT_DESC"), 'sHelpText': help_text("D3_ORDERMANAGER_MAIN_SORT_DESC")} %}
                        </td>
                    </tr>
                    <tr>
                        <td class="edittext">
                            <label for="MainFolder">{{ translate({ ident: "D3_MODPROFILE_MAIN_FOLDER" }) }}</label>&nbsp;
                        </td>
                        <td class="edittext">
                            <select id="MainFolder" class="editinput" size="1" name="editval[{{ edit.d3GetFieldLongName('oxfolder') }}]" {{ readonly }}>
                                <option value="" {% if '' == edit.getFieldData('oxfolder') %} selected{% endif %}>{{ translate({ ident: "D3_MODPROFILE_MAIN_NOFOLDER" }) }}</option>
                                {% for sMLItem, sTranslation in oView.getFolderList() %}
                                    <option value="{{ sMLItem }}" {% if sMLItem == edit.getFieldData('oxfolder') %} selected{% endif %}>{{ sTranslation }}</option>
                                {% endfor %}
                            </select>
                            {% include "inputhelp.html.twig" with {'sHelpId': help_id("D3_ORDERMANAGER_MAIN_FOLDER_DESC"), 'sHelpText': help_text("D3_ORDERMANAGER_MAIN_FOLDER_DESC")} %}
                        </td>
                    </tr>

                    <tr>
                        <td class="edittext">
                            {{ translate({ ident: "D3_ORDERMANAGER_MAIN_LASTEXEC" }) }}&nbsp;
                        </td>
                        <td class="edittext">
                            {{ edit.getValue('iLastExecDate')|date("Y-m-d H:i:S") }}
                        </td>
                    </tr>
                    {% if blShowLangSwitch %}
                        <tr>
                            <td class="edittext" colspan="2"><br>
                                {% include "language_edit.html.twig" %}<br>
                            </td>
                        </tr>
                    {% endif %}
                </table>

                <table style="border: none; padding: 0;">
                    {% include "@d3modcfg_lib/admin/inc/actionbuttons.html.twig" %}
                </table>
            </td>

            <!-- Anfang rechte Seite -->
            <td style="vertical-align: top; padding-top:10px;padding-left:10px;">
                <fieldset>
                    <legend>{{ translate({ ident: "D3_ORDERMANAGER_MAIN_FIELDSET_EXECUTION" }) }}</legend>

                    {% set markHighlight = (edit.getFieldData('oxactive') == 1 or (
                        blUseTimeCheck and (
                            edit.getFieldData('oxactivefrom') != '0000-00 - 00 00:00:00' and
                            edit.getFieldData('oxactiveto') != '0000-00 - 00 00:00:00'
                        )
                    )) and edit.getValue('blItemExecute') != 1 and edit.getValue('blItemMailSend') != 1 %}

                    <table style="border: none; padding: 0;">
                        <tr>
                            <td class="edittext" style="{% if markHighlight %}font-weight: bold; background-color: darkred; color: white;{% endif %}">
                                <label for="MainExecute">{{ translate({ ident: "D3_ORDERMANAGER_MAIN_EXECUTE2" }) }}{% if oSet.hasDebugMode() %}<br><span id="debugnote">{{ translate({ ident: "D3_ORDERMANAGER_MAIN_EXECUTE_DEBUG" }) }}</span>{% endif %}</label>
                            </td>
                            <td class="edittext">
                                <input type="hidden" name="value[blItemExecute]" value="1">
                                <input id="MainExecute" type="checkbox" {% if oSet.hasDebugMode() %}disabled{% endif %} class="edittext ext_edittext" name="value[blItemExecute]" value="0" {% if false == edit.getValue('blItemExecute') %}checked{% endif %} {{ readonly }}>
                                {% include "inputhelp.html.twig" with {'sHelpId': help_id("D3_ORDERMANAGER_MAIN_EXECUTE_DESC"), 'sHelpText': help_text("D3_ORDERMANAGER_MAIN_EXECUTE_DESC")} %}
                            </td>
                        </tr>
                        <tr>
                            <td class="edittext" style="{% if markHighlight %}font-weight: bold; background-color: darkred; color: white;{% endif %}">
                                <label for="MainMailsend">{{ translate({ ident: "D3_ORDERMANAGER_MAIN_MAILSEND" }) }}</label>&nbsp;
                            </td>
                            <td class="edittext">
                                <input type="hidden" name="value[blItemMailSend]" value="0">
                                <input id="MainMailsend" type="checkbox" class="edittext ext_edittext" name="value[blItemMailSend]" value="1" {% if edit.getValue('blItemMailSend') %}checked{% endif %} {{ readonly }}>
                                {% include "inputhelp.html.twig" with {'sHelpId': help_id("D3_ORDERMANAGER_MAIN_MAILSEND_DESC"), 'sHelpText': help_text("D3_ORDERMANAGER_MAIN_MAILSEND_DESC")} %}
                            </td>
                        </tr>
                        <tr>
                            <td class="edittext">
                                <label for="AddHistory">{{ translate({ ident: "D3_ORDERMANAGER_MAIN_ADDHISTORYITEM" }) }}</label>
                            </td>
                            <td class="edittext">
                                <input type="hidden" name="value[blAddHistory]" value="0">
                                <input id="AddHistory" type="checkbox" class="edittext ext_edittext" name="value[blAddHistory]" value="1" {% if edit.getValue('blAddHistory') %}checked{% endif %} {{ readonly }}>
                                {% include "inputhelp.html.twig" with {'sHelpId': help_id("D3_ORDERMANAGER_MAIN_ADDHISTORYITEM_DESC"), 'sHelpText': help_text("D3_ORDERMANAGER_MAIN_ADDHISTORYITEM_DESC")} %}
                            </td>
                        </tr>
                    </table>
                </fieldset>
            </td>
<!-- Ende rechte Seite -->
        </tr>
    </table>
</form>

{% include "@d3modcfg_lib/admin/inc/inc.html.twig" %}
